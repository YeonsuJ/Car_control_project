# [1주차] 주간 개발 일지 (25-05-12 ~ 25-05-18)

## 1. 이번주 작업 내용
- 초기 아이디어 구상
- 보드 및 부품 선정 후 구매
- 마일드스톤 개괄 작성

## 2. 내용정리

### 2-1. 초기 아이디어 도출과정 및 1차 프로젝트 목표

#### < 프로젝트 명 >
사용자 경험 기반 주행이 가능한 RC카 구현 

#### < 아이디어 도출과정 >
최근 운전면허를 취득하고도 실제 운전에 대한 두려움으로 인해 운전을 시도하지 못하는, 이른바 ‘장롱면허’가 사회적으로 늘어나고 있는 상황에서, 보다 쉽고 부담 없는 방식으로 운전에 대한 흥미를 유도할 수 있는 방법에 대해 고민하게 되었다.

이에 따라 접근성이 뛰어난 RC카를 활용하면서도 단순한 완구를 넘어 실제 차량과 유사한 주행 경험을 제공할 수 있는 시스템을 구현한다면, 이러한 사회적 문제 해결에 기여할 수 있을 것이라 판단하였다.

기존 RC카는 좌우 스틱과 전진/후진 버튼을 사용하는 조작 방식으로 구성되어 있으며, 이는 실제 차량의 운전 방식과 큰 차이가 있어 사용자에게 직관적인 조작감을 주지 못하고, 주행의 현실감과 몰입도를 떨어뜨리는 한계를 가지고 있다.

이러한 문제를 개선하기 위해, 실제 차량의 조향 방식에 가깝고 원활한 주행 환경을 제공하는 사용자 경험(UX)을 구현할 수 있는 방법을 모색하였으며, 이에 따라 다음과 같은 기능을 중심으로 시스템을 설계하였다. 

1. RF통신 기반 핸들 구현<br/>
핸들에 부착된 6축 자이로 센서를 통해 회전 동작을 감지하고, 택트 및 로커 스위치를 통해 악셀·브레이크·기어변속을 입력받아 RF 기반 무선 통신으로 RC카로 전송함으로써 실제 차량과 유사한 조향 및 주행 제어

2. 충돌 경고 햅틱 시스템<br/>
차량에 부착된 초음파 센서를 통해 장애물과의 거리를 측정하고, 충돌 직전에 핸들에 햅틱 진동을 전달하여 사용자에게 경고 신호를 제공하는 시스템을 구축

3. 방향지시등 구현<br/>
핸들에 부착된 3단 토글 스위치를 활용하여 좌·우 방향지시등을 작동

4. 속도 피드백 표시<br/>
DC 모터에 엔코더를 장착하여 차량의 실시간 속도를 측정하고, 이를 핸들에 부착된 OLED 디스플레이를 통해 사용자에게 시각적으로 피드백하도록 구현

5. CAN 기반 MCU 간 통신 구조<br/>
데이터 전송의 안정성과 시스템 확장성을 확보하기 위해 실제 차량의 ECU 구조를 모사한 CAN 통신을 구현하여 RC카 내부의 MCU가 각각 조향 제어, 센서 처리, 모터 제어 등 다양한 기능을 분담하여 동작하도록 구현

6. FreeRTOS 기반 병렬 처리 시스템<br/>
실시간성과 응답성을 강화하고, 기능 간 간섭 없이 안정적으로 동작할 수 있도록 MCU내의 전체 시스템을 FreeRTOS를 기반으로 구성하며, 조향 입력, 주행 제어, 장애물 감지, 햅틱 피드백 등의 기능을 각각 태스크(Task)로 나누어 병렬로 처리할 수 있도록 구현

이러한 시스템을 통해 초보 운전자들이 가장 어려움을 느끼는 여러 주차 상황(평행주차, T자 주차, 전/후면 주차,등)을 간접적으로 연습할 수 있으며, 방향지시등 작동 등과 같은 실제 주행 시 필요한 습관을 자연스럽게 익힐 수 있다.

이처럼 본 프로젝트는 단순한 RC카가 아닌, 실제 운전 방식과 유사한 인터페이스와 기능을 통합한 교육용·연구용 플랫폼으로서의 가능성을 염두에 두고 설계하였다. 실내외 환경 모두에서 몰입감 있는 주행 경험을 제공하며, UX 연구, 운전 훈련, 교육 시뮬레이션 등의 다양한 분야에서 활용할 수 있는 확장성 높은 RC카 시스템 구현을 목표로 한다.


### 2-2. 보드 및 부품 선정
MCU로는 32bit cortex-m3, m4 기반의 stm32보드를 선정하였으며, 핸들에는 stm32f103c8t6, 차량에는 메인 MCU로 stm32f446re를, 각 기능별 서브 MCU로 stm32f103c8t6 보드 2개를 선정하였다.

**STM32F103C8T6**는 Cortex-M3 기반의 72MHz의 충분한 클럭 속도를 기반으로 핸들의 복잡한 입출력을 안정적으로 처리할 수 있으며, SPI 기반의 RF 통신 모듈과의 연동도 용이해 무선 데이터 전송에도 적합하다. 경량화가 요구되는 핸들 구조에 적합한 소형 패키지를 제공하며, 차량 내부 네트워크 관점에서는 하드웨어적으로 내장된 CAN 컨트롤러를 통해 다른 MCU들과 안정적인 통신을 구성할 수 있다는 장점이 있다. 또한 서브 시스템 제어에 적합한 안정성과 경제성을 갖추고 있어, FreeRTOS 기반 구조에서도 초음파, 조도, 충격 감지 센서 등의 데이터를 효율적으로 병렬 처리하고, 이를 CAN 통신으로 주기적으로 전송하는 데에도 유리한 구조를 제공한다.

**STM32F446RE**는 Cortex-M4 기반의 최대 180MHz의 클럭 속도와 하드웨어 부동소수점 연산 장치(FPU)를 내장하고 있어, 고속 연산이 필요한 실시간 주행 제어에 적합하며, FreeRTOS 기반의 멀티태스킹 환경에서도 안정적으로 동작한다. 특히 PID 기반의 DC 모터 제어, 엔코더 피드백 처리, 서보모터 조향 제어와 같은 정밀한 제어 연산에서 높은 연산 성능과 실시간 응답성을 제공한다.

또한 RF 통신 모듈(nRF24L01 등)과의 SPI 연동, 다양한 센서 입력, PWM 기반 모터 제어 등이 용이하며, FreeRTOS를 통해 RF 통신, 제어 명령 처리, 센서 수집을 태스크 단위로 분리함으로써 병렬성과 안정성을 모두 확보할 수 있다. 차량 내에서는 중앙 제어 MCU로서 CAN 통신을 하드웨어적으로 지원하므로, 복수의 서브 MCU들과 안정적인 네트워크를 구성하고, 센서 데이터 수신 및 제어 명령 분배 등의 CAN 마스터 역할을 수행하기에 적합한 구조를 제공한다.

뿐만 아니라, stm32보드의 풍부한 주변장치(UART, TIM, ADC, I2C, SPI 등)와 널리 검증된 HAL/LL 드라이버 생태계 덕분에 디버깅과 유지보수가 용이하며, STM32CubeMX 및 STM32CubeIDE를 통해 생산성과 확장성 있는 임베디드 시스템 개발이 가능한 장점이 있다.

-> [자세한 부품 사항](../parts_list.md)

### 2-3. 마일드스톤 개괄 (약 3~4개월 예상)
- 1주~4주차 : 아이디어 구상 및 각 기능 모듈화
- 5주~8주차 : 각 모듈 RTOS 기반 태스크 스케줄링
- 9주~12주차 : 통신 프로토콜 작성 및 구현
- 13주~16주차 : 차량 및 컨트롤러 하드웨어 어셈블 후 시연

## 3. 다음주 목표
- Git commands 학습 및 STM32CubeIDE 와 Git & Github 관리/연동, 버전관리법 학습
- 초음파센서 test
- OLED test
- tactile switch 제어
